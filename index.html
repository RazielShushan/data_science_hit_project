<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>3ae9d92b1b764674854672bb98a9a632</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>run Movies<span class="op">-</span>data<span class="op">-</span>organize<span class="op">-</span>cleaning.ipynb</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>run EDA_visualization.ipynb</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>run Movies<span class="op">-</span>Supervised_learning.ipynb</span></code></pre></div>
</div>
<section id="introduction" class="cell markdown">
<h1>Introduction</h1>
</section>
<div class="cell markdown">
<h3 id="about-us">About Us:</h3>
<p>We are Raziel Shushan and Rom Basson, second year computer science students at HIT College. Our project is in a data science course taught by Dr. Jonathan Scheller.</p>
<h3 id="what-is-the-project-about">What is the project about?</h3>
<p>In the project we are trying to understand whether it is possible to predict revenue for a film that was screened in the cinema based on data from several sources of information. Calculation of income per film = income in the country of origin + income from countries to which the film was distributed.</p>
<h3 id="why-did-we-choose-this-project">Why did we choose this project?</h3>
<p>Cinema for us is not just a movie and popcorn. It's watching the movie page on IMDB, reading reviews and of course lots of talk before watching the movie itself. Therefore, it was natural to choose this subject especially after the Corona period when cinemas in Israel were shut down and the lack was felt so much.</p>
<h3 id="a-little-about-the-code">A little about the code:</h3>
<p>You can view the source code at GitHab on the following link - <a href="https://github.com/RazielShushan/data_science_hit_project.git" class="uri">https://github.com/RazielShushan/data_science_hit_project.git</a> In this notebook we will use the functions we built in the other notebooks according to the steps in the project, you can view the full code in the notebooks:</p>
<ul>
<li><a href="./Scraping_movies.ipynb">Scraping_movies.ipynb</a> – Scraping information for the movies</li>
<li><a href="./Scraping_movie_list.ipynb">Scraping_movie_list.ipynb</a> - Scraping the movie list from wildaboutmovies.com</li>
<li><a href="./Request_utils.ipynb">Request_utils.ipynb</a> - Notebook with utils functions</li>
<li><a href="./Movies-data-organize-cleaning.ipynb">Movies-data-organize-cleaning.ipynb</a> - Notebook with auxiliary functions for organizing and cleaning the DATASET</li>
<li><a href="./EDA_visualization.ipynb">EDA_visualization.ipynb</a> – Notebook with basic and advanced visualization functions</li>
<li><a href="./Movies-Supervised_learning.ipynb">Movies-Supervised_learning.ipynb</a> – Notebook with machine learning functions</li>
</ul>
</div>
<section id="step-1---scrape-the-data" class="cell markdown">
<h1>Step 1 - Scrape the data</h1>
<h3 id="about-the-data">About the data:</h3>
<p>When we approached the project, we realized that there is a difficulty in separating within the Box office site (an IMDB site that displays revenue data) between films that were distributed for broadcast on DVD, Netflix, Amazon Prime, etc' and films that featured in cinemas.</p>
<p>Therefore, we used two different sources of information –</p>
<ol>
<li><a href="https://www.wildaboutmovies.com/" class="uri">https://www.wildaboutmovies.com/</a> - A site that lists the movies screened in the United States from 2007 to 2021.</li>
<li><a href="http://boxofficemojo.com/" class="uri">http://boxofficemojo.com/</a> - A site that shows the revenue data for movies and much more information.</li>
</ol>
<h3 id="dataset-retrieval-process">Dataset Retrieval Process:</h3>
<p>We performed the data scraping process with the help of Beautiful soup, the retrieval on the first site was quick because all that was required was to index all the links on the home page that refer to the list of films by year and save the relevant data ( "movie name" and "year of release"). In total We retrieved 6398 movies and the process took several hours. (A small anecdote: when making the scraping on the site apparently the load of requests collapsed the site for a few hours and then the IP address we accessed was blocked, of course there was no difficulty in bypassing this block by connecting to VPN)</p>
<p>The second step, on the other hand, was more complex, because we had to simulate a movie search on the site and verify that we found a movie that matched the relevant details (movie and release year match).</p>
<p>The scraping process took several days due to the number of requests. (We did not execute a parallel run so as not to be blocked)</p>
<p>In total we were able to export data on about 5400 movies, the rest of the movies were not found in the database, we performed a manual search sample and indeed we did not find these movies on the destination site.</p>
<p>We decided to pull out almost all the existing information about the film because we did not yet know what data we would use and where there are correlations between the various data so the table contains about 31 columns that contain a lot of information about the film.</p>
<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=726
 style='width:544.75pt;border-collapse:collapse'>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>&nbsp;</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><b><span
  lang=en-IL style='color:black'>Column Name</span></b></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><b><span
  lang=en-IL style='color:black'>Description</span></b></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><b><span
  lang=en-IL style='color:black'>&nbsp;</span></b></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><b><span
  lang=en-IL style='color:black'>Column Name</span></b></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border:solid windowtext 1.0pt;
  border-left:none;background:#E7E6E6;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><b><span
  lang=en-IL style='color:black'>Description</span></b></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>1</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>movie_name</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The name of the film</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>17</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>producer_names</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The names of the producers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>2</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>movie_link</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Link the movie page on the Box Office website</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>18</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>producer_sum</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total producers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>3</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>year</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Year of release of the film</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>19</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>composer_names</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The names of the composers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>4</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>description</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Movie description</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>20</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>composer_sum</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total composers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>5</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>genres</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The genres</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>21</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>cinematographer_names</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The names of the photographers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>6</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>running_time</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Movie time</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>22</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>cinematographer_sum</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total photographers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>7</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>earliest_release_date</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Date of release of the film</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>23</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>editor_names</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Names of editors</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>8</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>mpaa</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Viewing classification</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>24</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>editor_sum</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total editors</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>9</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>budget</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Movie budget</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>25</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>production_designer_names</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Names of production designers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>10</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>preformence</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The performance of the film is divided into each
  country where the film was screened</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>26</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>production_designer_sum</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total production designers</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>11</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>num_of_countries</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total countries in which the film was screened</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>27</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>domestic_income</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Income in the country of origin of the film</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>12</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>cast</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Leading actors in the film</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>28</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>domestic_percent</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Percentage of income in the country of origin of
  the film</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>13</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>director_names</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The names of the directors</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>29</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>international_income</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Income from an international source (relative to
  the country of origin)</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>14</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>director_sum</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total directors</span></p>
  </td>
  <td width=32 nowrap valign=bottom style='width:23.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>30</span></p>
  </td>
  <td width=193 nowrap valign=bottom style='width:144.65pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>international_percent</span></p>
  </td>
  <td width=180 nowrap valign=bottom style='width:134.8pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The percentage of income from the country of
  origin of the film from the world income</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>15</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>writer_names</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>The names of the screenwriters</span></p>
  </td>
  <td width=32 nowrap rowspan=2 valign=bottom style='width:23.65pt;border-top:
  none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>31</span></p>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  dir=LTR></span><span lang=en-IL style='color:black'><span dir=LTR></span>&nbsp;</span></p>
  </td>
  <td width=193 nowrap rowspan=2 valign=bottom style='width:144.65pt;
  border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>worldwide_income</span></p>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  dir=RTL></span><span lang=HE dir=RTL style='color:black'><span dir=RTL></span>&nbsp;</span></p>
  </td>
  <td width=180 nowrap rowspan=2 valign=bottom style='width:134.8pt;border-top:
  none;border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>Total global income&nbsp;</span></p>
  </td>
 </tr>
 <tr style='height:14.4pt'>
  <td width=29 nowrap valign=bottom style='width:22.0pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal align=right style='margin-bottom:0cm;text-align:right;
  line-height:normal'><span lang=en-IL style='color:black'>16</span></p>
  </td>
  <td width=143 nowrap valign=bottom style='width:107.4pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal style='margin-bottom:0cm;line-height:normal'><span
  lang=en-IL style='color:black'>writer_sum</span></p>
  </td>
  <td width=150 nowrap valign=bottom style='width:112.25pt;border-top:none;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:14.4pt'>
  <p class=MsoNormal dir=RTL style='margin-bottom:0cm;text-align:right;
  line-height:normal;direction:rtl;unicode-bidi:embed'><span lang=en-IL
  dir=LTR style='color:black'>Total screenwriters</span></p>
  </td>
 </tr>
</table>
</section>
<section id="step-2---preliminary-analysis" class="cell markdown">
<h1>Step 2 - Preliminary analysis:</h1>
</section>
<section id="load-the-data" class="cell markdown">
<h3>Load the data:</h3>
<p>After the scraping process we stored the dataset inside a data folder. We will load the data and look at the top of the list.</p>
</section>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> load_csv(<span class="st">&quot;./data/All_movies_table.csv&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_name</th>
      <th>movie_link</th>
      <th>year</th>
      <th>description</th>
      <th>genres</th>
      <th>running_time</th>
      <th>earliest_release_date</th>
      <th>mpaa</th>
      <th>budget</th>
      <th>preformence</th>
      <th>...</th>
      <th>cinematographer_sum</th>
      <th>editor_names</th>
      <th>editor_sum</th>
      <th>production_designer_names</th>
      <th>production_designer_sum</th>
      <th>domestic_income</th>
      <th>domestic_percent</th>
      <th>international_income</th>
      <th>international_percent</th>
      <th>worldwide_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>My Life Directed</td>
      <td>https://www.boxofficemojo.com/title/tt4029998/...</td>
      <td>2015</td>
      <td>Liv Corfixen documents her husband, filmmaker ...</td>
      <td>Documentary</td>
      <td>58.0</td>
      <td>27/02/2015</td>
      <td>PG-13</td>
      <td>NaN</td>
      <td>[['Domestic', 'Feb 27, 2015', '\n        \n   ...</td>
      <td>...</td>
      <td>1.0</td>
      <td>Cathrine Ambus</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Superpower Dogs</td>
      <td>https://www.boxofficemojo.com/title/tt5629084/...</td>
      <td>2019</td>
      <td>Discover the life-saving superpowers and extra...</td>
      <td>Documentary</td>
      <td>47.0</td>
      <td>29/08/2019</td>
      <td>G</td>
      <td>NaN</td>
      <td>[['United Kingdom', 'Oct 23, 2020', '$224', '$...</td>
      <td>...</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>32853.0</td>
      <td>100%</td>
      <td>32853.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A Beautiful Planet</td>
      <td>https://www.boxofficemojo.com/title/tt2800050/...</td>
      <td>2016</td>
      <td>An exploration of Earth and beyond as seen fro...</td>
      <td>Documentary</td>
      <td>46.0</td>
      <td>29/04/2016</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[['Domestic', 'Apr 29, 2016', '$223,983', '$15...</td>
      <td>...</td>
      <td>1.0</td>
      <td>Toni Myers</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>15650615.0</td>
      <td>60.80%</td>
      <td>10079505.0</td>
      <td>39.20%</td>
      <td>25730120.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hubble</td>
      <td>https://www.boxofficemojo.com/title/tt1433813/...</td>
      <td>2010</td>
      <td>An IMAX 3D camera chronicles the effort of 7 a...</td>
      <td>Documentary|Short</td>
      <td>45.0</td>
      <td>19/03/2010</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[['Domestic', 'Mar 19, 2010', '$413,477', '$52...</td>
      <td>...</td>
      <td>1.0</td>
      <td>Toni Myers</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>52522904.0</td>
      <td>70.70%</td>
      <td>21726825.0</td>
      <td>29.30%</td>
      <td>74249729.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Walking Deceased</td>
      <td>https://www.boxofficemojo.com/title/tt3743822/...</td>
      <td>2015</td>
      <td>A Walking Dead spinoff set in Los Angeles, Cal...</td>
      <td>Drama|Horror|Sci-Fi|Thriller</td>
      <td>44.0</td>
      <td>15/04/2018</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[['Domestic', 'Apr 15, 2018', '$605,764', '$60...</td>
      <td>...</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>605764.0</td>
      <td>100%</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>605764.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>As we described above there are 31 columns and 6399 lines, some of the lines are indeed empty but later it seems that most of them are full of good data 😊.</p>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<pre><code>(6399, 31)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>At this point we use the <span class="math inline"><em>i</em><em>n</em><em>f</em><em>o</em></span>() function to get a preliminary understanding on our columns.</p>
<p>It can be seen that most of the columns are full of content, however, there are some columns that suffer from a great shortage such as a budget column containing 1549 rows that are just NULL!, meaning that over 70 percent of the rows are empty of this content. So unfortunately, we will not use this column.</p>
<p>Also, the MPAA column is missing about 40 percent, but, since we have not yet deleted rows of irrelevant rows the percentage may have dropped so at this point we will keep this column.</p>
</div>
<div class="cell code" data-execution_count="4" data-scrolled="true">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 6399 entries, 0 to 6398
Data columns (total 31 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   movie_name                 6399 non-null   object 
 1   movie_link                 5493 non-null   object 
 2   year                       6399 non-null   int64  
 3   description                5485 non-null   object 
 4   genres                     5493 non-null   object 
 5   running_time               5483 non-null   float64
 6   earliest_release_date      5476 non-null   object 
 7   mpaa                       3960 non-null   object 
 8   budget                     1549 non-null   object 
 9   preformence                5484 non-null   object 
 10  num_of_countries           5484 non-null   float64
 11  cast                       5434 non-null   object 
 12  director_names             5433 non-null   object 
 13  director_sum               5434 non-null   float64
 14  writer_names               5177 non-null   object 
 15  writer_sum                 5434 non-null   float64
 16  producer_names             5358 non-null   object 
 17  producer_sum               5434 non-null   float64
 18  composer_names             4954 non-null   object 
 19  composer_sum               5434 non-null   float64
 20  cinematographer_names      5190 non-null   object 
 21  cinematographer_sum        5434 non-null   float64
 22  editor_names               5326 non-null   object 
 23  editor_sum                 5434 non-null   float64
 24  production_designer_names  4455 non-null   object 
 25  production_designer_sum    5434 non-null   float64
 26  domestic_income            4738 non-null   float64
 27  domestic_percent           4702 non-null   object 
 28  international_income       4419 non-null   float64
 29  international_percent      4401 non-null   object 
 30  worldwide_income           5337 non-null   float64
dtypes: float64(12), int64(1), object(18)
memory usage: 1.5+ MB
</code></pre>
</div>
</div>
<section id="clearing-the-data" class="cell markdown">
<h3>Clearing the data</h3>
<p>Because of the above data we will delete the budget column using the auxiliary function</p>
</section>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> delete_col_by_name(df,<span class="st">&quot;budget&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We will now delete double rows, in total we found 16 such rows</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> remove_duplicatives(df)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>(6383, 30)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We will now delete lines without critical information for further research:</p>
<ul>
<li><strong>Global income</strong> - This is our target column and without it you cannot run models.</li>
<li><strong>Link</strong> - The meaning of lines without a link is that there is no data beyond the name of the film and the year of release, so these lines are worthless</li>
</ul>
<p>After deleting we were left with 5321 lines.</p>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> delete_missing_lines(df,[<span class="st">&quot;movie_link&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>(5321, 30)</code></pre>
</div>
</div>
<section id="handling-categorical-columns" class="cell markdown">
<h3>Handling categorical columns</h3>
<p>We will now deal with the Categorical columns, <strong>genre</strong> and <strong>MPAA</strong> and will transfer them to numerical columns. For <strong>MPAA</strong> we will use a helper function to form a categorical column on dataset.</p>
</section>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> add_categorical_column(df,<span class="st">&#39;mpaa&#39;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;movie_name&quot;</span>,<span class="st">&quot;mpaa&quot;</span>,<span class="st">&quot;mpaa_cat&quot;</span>]]</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_name</th>
      <th>mpaa</th>
      <th>mpaa_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Superpower Dogs</td>
      <td>G</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A Beautiful Planet</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hubble</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Walking Deceased</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tornado Alley</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5754</th>
      <td>Youth In Oregon</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>5843</th>
      <td>Mayhem</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>5891</th>
      <td>The Barber</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>6178</th>
      <td>The Hole</td>
      <td>NaN</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>6301</th>
      <td>Walking On Dead Fish</td>
      <td>PG-13</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5321 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p>For the genre column it is a little bit complicated because there are many genres and each movie has more than one genre, so we added a column with the value <strong>0 or 1</strong> that verifies if the film belongs to this genre. We will use a helper function to divide the data into columns. The sign for separating the data to colomns is <strong>'|'</strong></p>
<p>After the transfer we had another 21 columns.</p>
</div>
<div class="cell code" data-execution_count="9" data-scrolled="false">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_division_of_data(df,<span class="st">&quot;genres&quot;</span>,<span class="st">&quot;|&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_name</th>
      <th>movie_link</th>
      <th>year</th>
      <th>description</th>
      <th>genres</th>
      <th>running_time</th>
      <th>earliest_release_date</th>
      <th>mpaa</th>
      <th>preformence</th>
      <th>num_of_countries</th>
      <th>...</th>
      <th>Romance</th>
      <th>Comedy</th>
      <th>Mystery</th>
      <th>Fantasy</th>
      <th>Western</th>
      <th>Musical</th>
      <th>unknown</th>
      <th>Sport</th>
      <th>Animation</th>
      <th>News</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Superpower Dogs</td>
      <td>https://www.boxofficemojo.com/title/tt5629084/...</td>
      <td>2019</td>
      <td>Discover the life-saving superpowers and extra...</td>
      <td>Documentary</td>
      <td>47.0</td>
      <td>29/08/2019</td>
      <td>G</td>
      <td>[['United Kingdom', 'Oct 23, 2020', '$224', '$...</td>
      <td>3.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A Beautiful Planet</td>
      <td>https://www.boxofficemojo.com/title/tt2800050/...</td>
      <td>2016</td>
      <td>An exploration of Earth and beyond as seen fro...</td>
      <td>Documentary</td>
      <td>46.0</td>
      <td>29/04/2016</td>
      <td>NaN</td>
      <td>[['Domestic', 'Apr 29, 2016', '$223,983', '$15...</td>
      <td>5.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hubble</td>
      <td>https://www.boxofficemojo.com/title/tt1433813/...</td>
      <td>2010</td>
      <td>An IMAX 3D camera chronicles the effort of 7 a...</td>
      <td>Documentary|Short</td>
      <td>45.0</td>
      <td>19/03/2010</td>
      <td>NaN</td>
      <td>[['Domestic', 'Mar 19, 2010', '$413,477', '$52...</td>
      <td>7.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Walking Deceased</td>
      <td>https://www.boxofficemojo.com/title/tt3743822/...</td>
      <td>2015</td>
      <td>A Walking Dead spinoff set in Los Angeles, Cal...</td>
      <td>Drama|Horror|Sci-Fi|Thriller</td>
      <td>44.0</td>
      <td>15/04/2018</td>
      <td>NaN</td>
      <td>[['Domestic', 'Apr 15, 2018', '$605,764', '$60...</td>
      <td>1.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tornado Alley</td>
      <td>https://www.boxofficemojo.com/title/tt1852955/...</td>
      <td>2011</td>
      <td>A team of storm chasers track a tornado.</td>
      <td>Documentary|Short</td>
      <td>43.0</td>
      <td>29/09/2011</td>
      <td>NaN</td>
      <td>[['Australia', 'Sep 29, 2011', '$69,637', '$17...</td>
      <td>1.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 55 columns</p>
</div>
</div>
</div>
<section id="handling-outliers" class="cell markdown">
<h3>Handling outliers</h3>
<p>We will now go through the significant numeric columns and look for outliers and remove the relevant rows It can be seen that there are anomalies in the running time column and therefore we will delete these lines (about 160 lines)</p>
</section>
<div class="cell code" data-execution_count="11" data-scrolled="false">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_name</th>
      <th>movie_link</th>
      <th>year</th>
      <th>description</th>
      <th>genres</th>
      <th>running_time</th>
      <th>earliest_release_date</th>
      <th>mpaa</th>
      <th>preformence</th>
      <th>num_of_countries</th>
      <th>...</th>
      <th>Romance</th>
      <th>Comedy</th>
      <th>Mystery</th>
      <th>Fantasy</th>
      <th>Western</th>
      <th>Musical</th>
      <th>unknown</th>
      <th>Sport</th>
      <th>Animation</th>
      <th>News</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5321</td>
      <td>5321</td>
      <td>5321.000000</td>
      <td>5313</td>
      <td>5321</td>
      <td>5312.000000</td>
      <td>5321</td>
      <td>3860</td>
      <td>5321</td>
      <td>5321.000000</td>
      <td>...</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
      <td>5321.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>5281</td>
      <td>5276</td>
      <td>NaN</td>
      <td>5147</td>
      <td>945</td>
      <td>NaN</td>
      <td>1992</td>
      <td>7</td>
      <td>5154</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Unstoppable</td>
      <td>https://www.boxofficemojo.com/title/tt1790864/...</td>
      <td>NaN</td>
      <td>Left without men in the dying days of the Amer...</td>
      <td>Drama</td>
      <td>NaN</td>
      <td>14/09/2018</td>
      <td>R</td>
      <td>[['Domestic', 'Oct 18, 2013', '$923,715', '$56...</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>3</td>
      <td>3</td>
      <td>NaN</td>
      <td>3</td>
      <td>412</td>
      <td>NaN</td>
      <td>15</td>
      <td>1970</td>
      <td>3</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2014.027814</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>104.536521</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.409509</td>
      <td>...</td>
      <td>0.187935</td>
      <td>0.311971</td>
      <td>0.100357</td>
      <td>0.103364</td>
      <td>0.012780</td>
      <td>0.016162</td>
      <td>0.001316</td>
      <td>0.032701</td>
      <td>0.050366</td>
      <td>0.003007</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.898136</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.164725</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22.127012</td>
      <td>...</td>
      <td>0.390697</td>
      <td>0.463342</td>
      <td>0.300504</td>
      <td>0.304462</td>
      <td>0.112333</td>
      <td>0.126112</td>
      <td>0.036250</td>
      <td>0.177869</td>
      <td>0.218721</td>
      <td>0.054758</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2007.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2011.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>92.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2014.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>102.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>113.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2021.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>288.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>88.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 55 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>get_outliers(df)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/5e6a3033c5476660f1966c67aa25e6fdf4781a76.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> remove_outliers_by_col(df,<span class="st">&#39;running_time&#39;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<pre><code>(5150, 55)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>get_outliers(df)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/076145162e53d4a632bd06b42bbb02fac650cbd6.png" /></p>
</div>
</div>
<section id="step-3---eda-visualization" class="cell markdown">
<h1>Step 3 - EDA Visualization</h1>
</section>
<div class="cell markdown">
<p>As known nothing better than getting a clear look at the data.<br> We will begin with looking by years. </br>You can see that 2018 leads with the number of movies, while 2020 and 2021 are a lot lower.</br> We can conclude from this that the reason is the corona epidemic leading to lower film output.</p>
</div>
<div class="cell code" data-execution_count="15" data-scrolled="false">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>get_vis_division_by_year(df)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/ec24f6e9929d5174493aa9f31e317a12889dfeba.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>In the genre column you can see that the <strong>drama</strong> leads and after that <strong>comedy</strong>.</p>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>get_vis_division_by_genres(df)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/256e6bb8c33139a7ed5475727d6f8ef2d238d310.png" /></p>
</div>
</div>
<section id="correlation-between-columns" class="cell markdown">
<h1>Correlation between columns</h1>
<p>Now we will find columns that influence the world revenue, in other words columns that have a high correlation with the objective.</p>
<p>This is the rating of the correlation between worldwide income and the 9 highest columns (closer to 1)</p>
<ol>
<li>international_income - <span class="math inline">0.981205</span><br />
</li>
<li>domestic_income - <span class="math inline">0.942356</span></li>
<li>num_of_countries - <span class="math inline">0.594504</span></li>
<li>Adventure - <span class="math inline">0.459514</span></li>
<li>writer_sum - <span class="math inline">0.319568</span></li>
<li>Action - <span class="math inline">0.301650</span></li>
<li>running_time - <span class="math inline">0.267464</span></li>
<li>Family - <span class="math inline">0.258684</span></li>
<li>Fantasy - <span class="math inline">0.238758</span></li>
</ol>
<h3 id="insights">Insights:</h3>
<ol>
<li>From the above data it is not surprising to note that the income columns have very high influence rates as from this data is derived the the final data. So our model will disregard this data.</li>
<li>Since in countries where the film was played more there was more income, it is clear why there is correlation between the columns.</li>
<li>Interesting to see the connection between income and the genre, which means that there is a high probability that the income will increase if the film is of action or adventure, genre.</li>
<li>The connection between the amount of writers and income is a very surprising connection, if we delve deeper into studies done on it we will surely find the reason for the issue, but at the moment this issue is a mystery to us.</li>
</ol>
</section>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df.corr()[<span class="st">&#39;worldwide_income&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">
<pre><code>year                      -0.022779
running_time               0.267464
num_of_countries           0.594504
director_sum               0.006995
writer_sum                 0.319568
producer_sum              -0.030170
composer_sum              -0.004200
cinematographer_sum       -0.079473
editor_sum                 0.082956
production_designer_sum    0.108815
domestic_income            0.942356
international_income       0.981205
worldwide_income           1.000000
mpaa_cat                   0.129268
Documentary               -0.143765
Short                           NaN
Drama                     -0.208594
Horror                    -0.044863
Sci-Fi                     0.272919
Thriller                   0.019713
Adventure                  0.459514
Biography                 -0.076869
Family                     0.258684
Music                     -0.031189
Action                     0.301650
History                   -0.064263
War                       -0.032016
Crime                     -0.016769
Romance                   -0.056425
Comedy                     0.072205
Mystery                   -0.005634
Fantasy                    0.238758
Western                   -0.025549
Musical                    0.124808
unknown                   -0.005477
Sport                     -0.027659
Animation                  0.254146
News                      -0.021953
Name: worldwide_income, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Now we will present in Scaater plots the connection between each of the above 9 columns and the target columns(worldwide_income), we can see where the connection is strong compared to a weak connection, as we said before, visualization is a 'game changer' 😊</p>
</div>
<div class="cell code" data-execution_count="18" data-scrolled="false">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>get_scatter_plot(df)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/6207c735f440619fe6084850aa304f88f7f314ac.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Following what was shown above we examined the relationship between the 9 variables above in order to find correlation with additional columns and then cross them using 3D_Scaater_plot where Z is the target column (worldwide_income)</p>
<ul>
<li><p>For running_time I did not find a strong correlation with other data</p></li>
<li><p>For sum_of_country we found that there is a correlation with the columns: | column name | corolation rate | | --- | --- | | mpaa | 0.357106 | | running_time | 0.298874 | | writer_sum | 0.307073 |</p></li>
<li><p>For writer_sum we found that there is a correlation with the columns: | column name | corolation rate | | --- | --- | | director_sum | 0.342248 | | composer_sum | 0.306485 | | editor_sum | 0.316701 | | production_designer_sum | 0.381229 |</p></li>
</ul>
</div>
<div class="cell code" data-execution_count="19" data-scrolled="false">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>get_two_3D_scaater_plot(df,<span class="st">&quot;num_of_countries&quot;</span>,<span class="st">&quot;running_time&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>,<span class="st">&quot;num_of_countries&quot;</span>,<span class="st">&quot;mpaa_cat&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>get_two_3D_scaater_plot(df,<span class="st">&quot;writer_sum&quot;</span>,<span class="st">&quot;director_sum&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>,<span class="st">&quot;writer_sum&quot;</span>,<span class="st">&quot;production_designer_sum&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>get_two_3D_scaater_plot(df,<span class="st">&quot;num_of_countries&quot;</span>,<span class="st">&quot;writer_sum&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>,<span class="st">&quot;writer_sum&quot;</span>,<span class="st">&quot;editor_sum&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>get_two_3D_scaater_plot(df,<span class="st">&quot;domestic_income&quot;</span>,<span class="st">&quot;international_income&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>,<span class="st">&quot;writer_sum&quot;</span>,<span class="st">&quot;composer_sum&quot;</span>,<span class="st">&quot;worldwide_income&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/ca432cc460b7c6ce2be843c22e8ffd473d04f684.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/614b038e309a6505098aed06a1bad9357793b73c.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/791c8b17b9f3fef70b0f339b6a526f4674118460.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/9065bd15707578fb614cee327770195a0993db42.png" /></p>
</div>
</div>
<section id="text-analysis" class="cell markdown">
<h3>Text Analysis:</h3>
<p>The textual columns can not be analyzed in the same way as the numeric columns, however we will try to find certain words that recur a lot and then check the relationship between them and the income.</p>
<p>In the first two graphs we analyzed the <strong>description</strong> column, and located the 20 most common words.</br> In the rest of the columns we only show Bar plot, in this project we will not try to predict the result with the help of these columns, nevertheless it is interesting to see the data visually.</p>
</section>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;description&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>get_wordcloud_vis_text_data(df,<span class="st">&quot;description&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/36dfee090fe286b2464f9450a9a49c5e92d20875.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/9b66e70ca8e2147cc9089ed01769fa83ccadfd25.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="21" data-scrolled="false">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;movie_name&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;cast&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;editor_names&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;cinematographer_names&quot;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;composer_names&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;producer_names&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>get_bar_vis_text_data(df,<span class="st">&quot;writer_names&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="index_data/55da0bb3e7b25093cc866fcbaab49ab5080801e4.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/520e4878739cbc0a6c2b56971e51382356303f84.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/c44404adea96dd80830b718f9ef75c96c77e6b0b.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/85972b7fe96e0499c94820015edf738c671cb1da.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/56ad417d4fd37223cd35cf034ad3ff16144d4adf.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/052467bf56ca34b98e6046e90f0e5e0e962c7784.png" /></p>
</div>
<div class="output display_data">
<p><img src="index_data/941dd87d5e55040ca8da4cd2c0cf81fce6236dec.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>After seeing the top 20 words in the description column, We will try to understand whether there is a connection between the use of this word in the description of the film and the amount of income.<br> For this purpose, we created a function that for each word adds a column and sums up the number of occurrences per word in the movie description</p>
<p>Then we examined the correlation and it can be seen that there is no close relationship between the common words and income Nevertheless, we will try to use this data in order to see if it has an impact on income prediction.</p>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>val,new_list <span class="op">=</span> get_table_with_top_values_coll(df,<span class="st">&quot;description&quot;</span>,<span class="st">&quot; &quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23" data-scrolled="false">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>val[new_list].corr()[<span class="st">&quot;worldwide_income&quot;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">
<pre><code>life               -0.058598
young              -0.041230
new                 0.073826
man                -0.044212
world               0.042317
family              0.002284
story              -0.057616
woman              -0.036601
love               -0.028502
old                -0.003773
years              -0.030748
year               -0.022765
year               -0.024544
home               -0.008350
father             -0.013535
finds              -0.012813
war                 0.002460
girl               -0.036250
group              -0.005502
friends             0.014404
worldwide_income    1.000000
Name: worldwide_income, dtype: float64</code></pre>
</div>
</div>
<section id="step-4---advanced-data-analysis---machine-learning" class="cell markdown">
<h1>Step 4 - Advanced Data Analysis - Machine Learning</h1>
<p>We will examine a model of linear regression on different tables in order to find the appropriate model to answer the research question.</br> Since we have done a lot of manipulations on our table we will use a dedicated function that performs everything we did above except deleting the exceptional values and splitting the description column. Next we will look at using these manipulations to optimize our models, but for now we will initialize the data</p>
</section>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> get_cleaning_data()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>In order to run a model of linear regression one must make sure that there are no NULL values, With the help of the INFO function it can be seen that there are now many Null cels in the table so we will only select the columns we find that there is a connection between them and the object of the study, and of course we will delete cells with missing information</p>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<pre><code>movie_name                      0
movie_link                      0
year                            0
description                     8
genres                          0
running_time                    9
earliest_release_date           0
mpaa                         1463
budget                       3791
preformence                     0
num_of_countries                0
cast                           55
director_names                 56
director_sum                   55
writer_names                  306
writer_sum                     55
producer_names                129
producer_sum                   55
composer_names                524
composer_sum                   55
cinematographer_names         294
cinematographer_sum            55
editor_names                  157
editor_sum                     55
production_designer_names    1003
production_designer_sum        55
domestic_income               599
domestic_percent              635
international_income          918
international_percent         936
worldwide_income                0
mpaa_cat                        0
Documentary                     0
Short                           0
Drama                           0
Horror                          0
Sci-Fi                          0
Thriller                        0
Adventure                       0
Biography                       0
Family                          0
Music                           0
Action                          0
History                         0
War                             0
Crime                           0
Romance                         0
Comedy                          0
Mystery                         0
Fantasy                         0
Western                         0
Musical                         0
unknown                         0
Sport                           0
Animation                       0
News                            0
dtype: int64</code></pre>
</div>
</div>
<section id="first-model" class="cell markdown">
<h3>First model</h3>
<p>We will mark the columns we want to delete as well as the columns that are deleted in a row if missing cells are found First we will run the model without the <strong>MPAA</strong> column, later we will try to run with it (although this significantly reduces the amount of data)</br> We will then run the <strong>get_ml_df()</strong> function which deletes the columns and clears missing rows as well as returns a table with numeric data only</p>
</section>
<div class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">&#39;international_income&#39;</span>,<span class="st">&#39;international_percent&#39;</span>,<span class="st">&#39;domestic_income&#39;</span>,<span class="st">&#39;domestic_percent&#39;</span>,<span class="st">&#39;mpaa&#39;</span> ,<span class="st">&#39;mpaa_cat&#39;</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> [<span class="st">&#39;writer_sum&#39;</span>,<span class="st">&#39;running_time&#39;</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df_test_1 <span class="op">=</span> get_ml_df(df,rows,cols)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We will make sure that there are no missing cells and <u>all</u> the columns are numeric</p>
</div>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_test_1.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 5279 entries, 1 to 5482
Data columns (total 35 columns):
 #   Column                   Non-Null Count  Dtype  
---  ------                   --------------  -----  
 0   year                     5279 non-null   int64  
 1   running_time             5279 non-null   float64
 2   num_of_countries         5279 non-null   float64
 3   director_sum             5279 non-null   float64
 4   writer_sum               5279 non-null   float64
 5   producer_sum             5279 non-null   float64
 6   composer_sum             5279 non-null   float64
 7   cinematographer_sum      5279 non-null   float64
 8   editor_sum               5279 non-null   float64
 9   production_designer_sum  5279 non-null   float64
 10  worldwide_income         5279 non-null   float64
 11  Documentary              5279 non-null   int64  
 12  Short                    5279 non-null   int64  
 13  Drama                    5279 non-null   int64  
 14  Horror                   5279 non-null   int64  
 15  Sci-Fi                   5279 non-null   int64  
 16  Thriller                 5279 non-null   int64  
 17  Adventure                5279 non-null   int64  
 18  Biography                5279 non-null   int64  
 19  Family                   5279 non-null   int64  
 20  Music                    5279 non-null   int64  
 21  Action                   5279 non-null   int64  
 22  History                  5279 non-null   int64  
 23  War                      5279 non-null   int64  
 24  Crime                    5279 non-null   int64  
 25  Romance                  5279 non-null   int64  
 26  Comedy                   5279 non-null   int64  
 27  Mystery                  5279 non-null   int64  
 28  Fantasy                  5279 non-null   int64  
 29  Western                  5279 non-null   int64  
 30  Musical                  5279 non-null   int64  
 31  unknown                  5279 non-null   int64  
 32  Sport                    5279 non-null   int64  
 33  Animation                5279 non-null   int64  
 34  News                     5279 non-null   int64  
dtypes: float64(10), int64(25)
memory usage: 1.4 MB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>We will split the dataset into 2 separate tables</p>
<ul>
<li>train</li>
<li>test</li>
</ul>
<p>Also we will remove the income column that we want to predict for each dataset</p>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>train, test <span class="op">=</span> split_table_to_train_and_test(df_test_1)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>X_train, y_train <span class="op">=</span> split_dataset(train,<span class="st">&#39;worldwide_income&#39;</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>X_test, y_test <span class="op">=</span> split_dataset(test,<span class="st">&#39;worldwide_income&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>The moment of truth has arrived :) Now we can train our first linear regression model!</p>
</div>
<div class="cell code" data-execution_count="33">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>trained_mode <span class="op">=</span> train_model(X_train, y_train)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We will use the model to examine the dataset we have assigned to the test</p>
</div>
<div class="cell code" data-execution_count="34">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pred_vals <span class="op">=</span> predict(trained_mode, X_test)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>We will evaluate our model using R2 value calculation.</br> <strong>0.4&gt;R2</strong></br> This is definitely a great result relative to the first model!</p>
</div>
<div class="cell code" data-execution_count="35">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>y_pred<span class="op">=</span> pd.Series(pred_vals,index<span class="op">=</span>X_test.index)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>eval_res <span class="op">=</span> evaluate_performance(y_test, y_pred)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>eval_res</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">
<pre><code>0.41883197401071204</code></pre>
</div>
</div>
<section id="second-model" class="cell markdown">
<h3>Second model</h3>
<p>We will now examine whether the <strong>MPAA</strong> column improves our model</p>
</section>
<div class="cell code" data-execution_count="71">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> get_cleaning_data()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> delete_missing_lines(df,[<span class="st">&#39;mpaa&#39;</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">&#39;international_income&#39;</span>,<span class="st">&#39;international_percent&#39;</span>,<span class="st">&#39;domestic_income&#39;</span>,<span class="st">&#39;domestic_percent&#39;</span>]</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>df_test_2 <span class="op">=</span> get_ml_df(df,rows,cols)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Excellent! We improved the result</p>
</div>
<div class="cell code" data-execution_count="72">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>calculate_lr_R2(df_test_2,<span class="st">&#39;worldwide_income&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="72">
<pre><code>0.5278908498195151</code></pre>
</div>
</div>
<section id="third-model" class="cell markdown">
<h3>Third model</h3>
<p>We will now try to add to the model the manipulation we showed on the <strong>description</strong> column</p>
</section>
<div class="cell code" data-execution_count="40">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> [<span class="st">&#39;writer_sum&#39;</span>,<span class="st">&#39;running_time&#39;</span>,<span class="st">&#39;description&#39;</span>,<span class="st">&#39;mpaa&#39;</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> get_cleaning_data()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> delete_col_by_name(df,cols)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> delete_missing_lines(df,rows)    </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>val,new_list <span class="op">=</span> get_table_with_top_values_coll(df,<span class="st">&quot;description&quot;</span>,<span class="st">&quot; &quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> delete_col_by_name(val,[<span class="st">&#39;worldwide_income&#39;</span>,<span class="st">&#39;year&#39;</span>])</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>df[val.columns] <span class="op">=</span> val</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="59">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_test_3 <span class="op">=</span> get_ml_df(df,rows,<span class="va">None</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Unfortunately this did not contribute to improve the model :(</p>
</div>
<div class="cell code" data-execution_count="60" data-scrolled="true">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>calculate_lr_R2(df_test_3,<span class="st">&#39;worldwide_income&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">
<pre><code>0.4483998131011365</code></pre>
</div>
</div>
<section id="conclusion" class="cell markdown">
<h1>Conclusion:</h1>
<p>There is a lot more to do, but time is limited and we are not short on courses :)</br> We can continue to delve into the data and make more complex visualizations and of course try to import missing information and add to the existing dataset.</p>
<p>When we approached the project based mainly on the film budget, but once we finished pulling out the information we realized that this is an information gap that will be complex to bridge and yet the use of data such as genres, description, film time etc.. proved to be very effective, our R2 score get's more then 0.5! So consequently, it was worth the complexity.</p>
<p>If you have come this far, we would love to hear feedback that will help us learn and draw conclusions for the next project in this fascinating field.</p>
</section>
</body>
</html>
